function [ h,s,v ] = fix_rgb2hsv( r,g,b )

sign = 1; % signed
prec_i = 8; % NC
prec_f = 8;  % NU
word = 1 + prec_i + prec_f;

r = r/255;
g = g/255;
b = b/255;
[r_fix,g_fix,b_fix] = fi([r,g,b],1,word,prec_f,'RoundingMethod','Floor');

max_fix = max([r_fix,g_fix,b_fix]);
min_fix = min([r_fix,g_fix,b_fix]);

diff_fix = max_fix-min_fix;

v = floor(double(max_fix));
if(v == 0)
    s = 0;
else
    s = floor(double(diff_fix/v));
end

sixty_fix = fi(60,1,word,prec_f,'RoundingMethod','Floor');

if(diff_fix == 0)
    h = 0;
elseif(v == r)
    h = sixty_fix * (G - B)/diff_fix;
elseif(v == g)
    h = sixty_fix * (B - R)/diff_fix;
else
    h = sixty_fix * (R - G)/diff_fix;
end;

if(h < 0)
    h = h + 360;
end;


h = floor(double(h)*255);
s = floor(double(s)*255);
v = floor(double(v)*255);

end

